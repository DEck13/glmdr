
R version 3.5.1 (2018-07-02) -- "Feather Spray"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
>  library(glmdr)
>  library(numDeriv)
> 
>  data(sports)
> 
>  gout <- glmdr(cbind(wins, losses) ~ 0 + ., family = "binomial", data = sports)
>  gout <- gout$gout
>  summary(gout)

Call:
stats::glm(formula = cbind(wins, losses) ~ 0 + ., family = "binomial", 
    data = sports, x = TRUE)

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.16918   0.00001   0.00002   0.00004   0.61527  

Coefficients: (1 not defined because of singularities)
         Estimate Std. Error z value Pr(>|z|)
ants    4.574e+01  1.529e+04   0.003    0.998
beetles 2.479e+01  9.789e+03   0.003    0.998
cows    2.407e+01  9.789e+03   0.002    0.998
dogs    2.176e+01  9.789e+03   0.002    0.998
egrets  2.233e+01  9.789e+03   0.002    0.998
foxes   2.176e+01  9.789e+03   0.002    0.998
gerbils 1.279e-16  1.414e+00   0.000    1.000
hogs           NA         NA      NA       NA

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 60.997  on 28  degrees of freedom
Residual deviance:  3.391  on 21  degrees of freedom
AIC: 25.709

Number of Fisher Scoring iterations: 21

> 
>  # extract model matrix, response vector, and offset vector
> 
>  modmat <- gout$x
>  mf <- model.frame(gout)
>  resp <- model.response(mf)
>  offs <- model.offset(mf)
> 
>  modmat
   ants beetles cows dogs egrets foxes gerbils hogs
1     1      -1    0    0      0     0       0    0
2     1       0   -1    0      0     0       0    0
3     0       1   -1    0      0     0       0    0
4     1       0    0   -1      0     0       0    0
5     0       1    0   -1      0     0       0    0
6     0       0    1   -1      0     0       0    0
7     1       0    0    0     -1     0       0    0
8     0       1    0    0     -1     0       0    0
9     0       0    1    0     -1     0       0    0
10    0       0    0    1     -1     0       0    0
11    1       0    0    0      0    -1       0    0
12    0       1    0    0      0    -1       0    0
13    0       0    1    0      0    -1       0    0
14    0       0    0    1      0    -1       0    0
15    0       0    0    0      1    -1       0    0
16    1       0    0    0      0     0      -1    0
17    0       1    0    0      0     0      -1    0
18    0       0    1    0      0     0      -1    0
19    0       0    0    1      0     0      -1    0
20    0       0    0    0      1     0      -1    0
21    0       0    0    0      0     1      -1    0
22    1       0    0    0      0     0       0   -1
23    0       1    0    0      0     0       0   -1
24    0       0    1    0      0     0       0   -1
25    0       0    0    1      0     0       0   -1
26    0       0    0    0      1     0       0   -1
27    0       0    0    0      0     1       0   -1
28    0       0    0    0      0     0       1   -1
attr(,"assign")
[1] 1 2 3 4 5 6 7 8
>  resp
   wins losses
1     2      0
2     2      0
3     1      1
4     2      0
5     2      0
6     2      0
7     2      0
8     2      0
9     1      1
10    1      1
11    2      0
12    2      0
13    2      0
14    1      1
15    1      1
16    2      0
17    2      0
18    2      0
19    2      0
20    2      0
21    2      0
22    2      0
23    2      0
24    2      0
25    2      0
26    2      0
27    2      0
28    1      1
>  offs
NULL
> 
>  # have to deal with dropped predictors
>  outies <- is.na(coefficients(gout))
> 
>  mymodmat <- modmat[ , ! outies]
> 
>  mlogl <- glmdr:::make.mlogl(mymodmat, resp, offs, "binomial")
> 
>  beta.test <- coefficients(gout)[! outies]
>  # we don't want to test where the gradient is nearly zero
>  beta.test <- 0.9 * beta.test
> 
>  mout <- mlogl(beta.test)
> 
>  # omit offset here because it is NULL
>  theta.test <- as.vector(mymodmat %*% beta.test)
> 
>  myval <- sum(ifelse(theta.test < 0,
+      - resp[ , "wins"] * theta.test + rowSums(resp) * log1p(exp(theta.test)),
+      resp[ , "losses"] * theta.test + rowSums(resp) * log1p(exp(- theta.test))))
> 
>  all.equal(mout$value, myval)
[1] TRUE
> 
>  mygrad <- grad(function(beta) mlogl(beta)$value, beta.test)
> 
>  all.equal(mout$gradient, mygrad)
[1] TRUE
> 
>  myhess <- jacobian(function(beta) mlogl(beta)$gradient, beta.test)
> 
>  all.equal(mout$hessian, myhess)
[1] TRUE
>  
>  # now poisson
> 
>  rm(list = ls())
> 
>  data(catrec)
> 
>  gout <- glmdr(y ~ 0 + (.)^3, family = "poisson", data = catrec)
>  gout <- gout$gout
>  summary(gout)

Call:
stats::glm(formula = y ~ 0 + (.)^3, family = "poisson", data = catrec, 
    x = TRUE)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5359  -0.5574  -0.1136   0.2234   1.6286  

Coefficients:
          Estimate Std. Error z value Pr(>|z|)    
v1        2.390980   0.256857   9.309  < 2e-16 ***
v2        1.896615   0.299530   6.332 2.42e-10 ***
v3        2.379624   0.262848   9.053  < 2e-16 ***
v4       -1.134431   0.517800  -2.191  0.02846 *  
v5        2.546845   0.239799  10.621  < 2e-16 ***
v6       -1.566498   0.511842  -3.061  0.00221 ** 
v7       -1.363815   0.543034  -2.511  0.01202 *  
v1:v2    -2.291435   0.426704  -5.370 7.87e-08 ***
v1:v3    -3.249078   0.411902  -7.888 3.07e-15 ***
v1:v4     0.313630   0.479640   0.654  0.51318    
v1:v5    -3.658933   0.430667  -8.496  < 2e-16 ***
v1:v6     0.844266   0.466216   1.811  0.07016 .  
v1:v7     0.328266   0.510705   0.643  0.52037    
v2:v3    -2.049499   0.398233  -5.146 2.65e-07 ***
v2:v4     0.992566   0.461719   2.150  0.03158 *  
v2:v5    -2.768421   0.432412  -6.402 1.53e-10 ***
v2:v6     0.513833   0.468375   1.097  0.27262    
v2:v7     0.478920   0.488022   0.981  0.32642    
v3:v4     0.147538   0.503718   0.293  0.76960    
v3:v5    -3.001973   0.385367  -7.790 6.71e-15 ***
v3:v6     0.310948   0.496332   0.626  0.53099    
v3:v7     0.142973   0.523683   0.273  0.78484    
v4:v5     0.134021   0.488164   0.275  0.78367    
v4:v6     0.874879   0.463605   1.887  0.05914 .  
v4:v7     0.879991   0.491273   1.791  0.07325 .  
v5:v6     1.526193   0.481254   3.171  0.00152 ** 
v5:v7     0.008078   0.496288   0.016  0.98701    
v6:v7     0.795493   0.483254   1.646  0.09974 .  
v1:v2:v3  2.686208   0.464640   5.781 7.41e-09 ***
v1:v2:v4 -0.006517   0.382052  -0.017  0.98639    
v1:v2:v5  0.234658   0.436837   0.537  0.59115    
v1:v2:v6 -0.428391   0.383540  -1.117  0.26402    
v1:v2:v7 -0.585799   0.386212  -1.517  0.12932    
v1:v3:v4  0.227840   0.394110   0.578  0.56319    
v1:v3:v5  3.639852   0.452403   8.046 8.58e-16 ***
v1:v3:v6  0.190047   0.389396   0.488  0.62551    
v1:v3:v7 -0.098148   0.401240  -0.245  0.80676    
v1:v4:v5  0.536377   0.389822   1.376  0.16884    
v1:v4:v6 -0.538916   0.365690  -1.474  0.14056    
v1:v4:v7 -0.380532   0.370647  -1.027  0.30458    
v1:v5:v6 -0.045209   0.391013  -0.116  0.90795    
v1:v5:v7  0.363760   0.394764   0.921  0.35681    
v1:v6:v7  0.177924   0.370811   0.480  0.63135    
v2:v3:v4 -0.436336   0.393783  -1.108  0.26784    
v2:v3:v5  3.019656   0.460261   6.561 5.35e-11 ***
v2:v3:v6 -0.369251   0.395412  -0.934  0.35039    
v2:v3:v7 -0.069415   0.403882  -0.172  0.86354    
v2:v4:v5 -0.086591   0.386622  -0.224  0.82278    
v2:v4:v6 -0.141738   0.372939  -0.380  0.70390    
v2:v4:v7 -0.171015   0.375626  -0.455  0.64891    
v2:v5:v6 -0.819144   0.388405  -2.109  0.03495 *  
v2:v5:v7 -0.017330   0.391677  -0.044  0.96471    
v2:v6:v7  0.446698   0.381235   1.172  0.24131    
v3:v4:v5 -0.213063   0.407908  -0.522  0.60144    
v3:v4:v6  0.329711   0.367269   0.898  0.36933    
v3:v4:v7 -0.137481   0.371889  -0.370  0.71162    
v3:v5:v6 -0.386974   0.407319  -0.950  0.34209    
v3:v5:v7  0.666460   0.409310   1.628  0.10347    
v3:v6:v7 -0.699245   0.371570  -1.882  0.05985 .  
v4:v5:v6 -0.480076   0.374533  -1.282  0.19991    
v4:v5:v7  0.079582   0.376047   0.212  0.83240    
v4:v6:v7 -0.007802   0.370176  -0.021  0.98318    
v5:v6:v7 -0.862352   0.376187  -2.292  0.02189 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 1043.745  on 128  degrees of freedom
Residual deviance:   43.513  on  65  degrees of freedom
AIC: 538.69

Number of Fisher Scoring iterations: 5

> 
>  # extract model matrix, response vector, and offset vector
> 
>  modmat <- gout$x
>  mf <- model.frame(gout)
>  resp <- model.response(mf)
>  offs <- model.offset(mf)
> 
>  modmat
    v1 v2 v3 v4 v5 v6 v7 v1:v2 v1:v3 v1:v4 v1:v5 v1:v6 v1:v7 v2:v3 v2:v4 v2:v5
1    0  0  0  0  0  0  0     0     0     0     0     0     0     0     0     0
2    1  0  0  0  0  0  0     0     0     0     0     0     0     0     0     0
3    0  1  0  0  0  0  0     0     0     0     0     0     0     0     0     0
4    1  1  0  0  0  0  0     1     0     0     0     0     0     0     0     0
5    0  0  1  0  0  0  0     0     0     0     0     0     0     0     0     0
6    1  0  1  0  0  0  0     0     1     0     0     0     0     0     0     0
7    0  1  1  0  0  0  0     0     0     0     0     0     0     1     0     0
8    1  1  1  0  0  0  0     1     1     0     0     0     0     1     0     0
9    0  0  0  1  0  0  0     0     0     0     0     0     0     0     0     0
10   1  0  0  1  0  0  0     0     0     1     0     0     0     0     0     0
11   0  1  0  1  0  0  0     0     0     0     0     0     0     0     1     0
12   1  1  0  1  0  0  0     1     0     1     0     0     0     0     1     0
13   0  0  1  1  0  0  0     0     0     0     0     0     0     0     0     0
14   1  0  1  1  0  0  0     0     1     1     0     0     0     0     0     0
15   0  1  1  1  0  0  0     0     0     0     0     0     0     1     1     0
16   1  1  1  1  0  0  0     1     1     1     0     0     0     1     1     0
17   0  0  0  0  1  0  0     0     0     0     0     0     0     0     0     0
18   1  0  0  0  1  0  0     0     0     0     1     0     0     0     0     0
19   0  1  0  0  1  0  0     0     0     0     0     0     0     0     0     1
20   1  1  0  0  1  0  0     1     0     0     1     0     0     0     0     1
21   0  0  1  0  1  0  0     0     0     0     0     0     0     0     0     0
22   1  0  1  0  1  0  0     0     1     0     1     0     0     0     0     0
23   0  1  1  0  1  0  0     0     0     0     0     0     0     1     0     1
24   1  1  1  0  1  0  0     1     1     0     1     0     0     1     0     1
25   0  0  0  1  1  0  0     0     0     0     0     0     0     0     0     0
26   1  0  0  1  1  0  0     0     0     1     1     0     0     0     0     0
27   0  1  0  1  1  0  0     0     0     0     0     0     0     0     1     1
28   1  1  0  1  1  0  0     1     0     1     1     0     0     0     1     1
29   0  0  1  1  1  0  0     0     0     0     0     0     0     0     0     0
30   1  0  1  1  1  0  0     0     1     1     1     0     0     0     0     0
31   0  1  1  1  1  0  0     0     0     0     0     0     0     1     1     1
32   1  1  1  1  1  0  0     1     1     1     1     0     0     1     1     1
33   0  0  0  0  0  1  0     0     0     0     0     0     0     0     0     0
34   1  0  0  0  0  1  0     0     0     0     0     1     0     0     0     0
35   0  1  0  0  0  1  0     0     0     0     0     0     0     0     0     0
36   1  1  0  0  0  1  0     1     0     0     0     1     0     0     0     0
37   0  0  1  0  0  1  0     0     0     0     0     0     0     0     0     0
38   1  0  1  0  0  1  0     0     1     0     0     1     0     0     0     0
39   0  1  1  0  0  1  0     0     0     0     0     0     0     1     0     0
40   1  1  1  0  0  1  0     1     1     0     0     1     0     1     0     0
41   0  0  0  1  0  1  0     0     0     0     0     0     0     0     0     0
42   1  0  0  1  0  1  0     0     0     1     0     1     0     0     0     0
43   0  1  0  1  0  1  0     0     0     0     0     0     0     0     1     0
44   1  1  0  1  0  1  0     1     0     1     0     1     0     0     1     0
45   0  0  1  1  0  1  0     0     0     0     0     0     0     0     0     0
46   1  0  1  1  0  1  0     0     1     1     0     1     0     0     0     0
47   0  1  1  1  0  1  0     0     0     0     0     0     0     1     1     0
48   1  1  1  1  0  1  0     1     1     1     0     1     0     1     1     0
49   0  0  0  0  1  1  0     0     0     0     0     0     0     0     0     0
50   1  0  0  0  1  1  0     0     0     0     1     1     0     0     0     0
51   0  1  0  0  1  1  0     0     0     0     0     0     0     0     0     1
52   1  1  0  0  1  1  0     1     0     0     1     1     0     0     0     1
53   0  0  1  0  1  1  0     0     0     0     0     0     0     0     0     0
54   1  0  1  0  1  1  0     0     1     0     1     1     0     0     0     0
55   0  1  1  0  1  1  0     0     0     0     0     0     0     1     0     1
56   1  1  1  0  1  1  0     1     1     0     1     1     0     1     0     1
57   0  0  0  1  1  1  0     0     0     0     0     0     0     0     0     0
58   1  0  0  1  1  1  0     0     0     1     1     1     0     0     0     0
59   0  1  0  1  1  1  0     0     0     0     0     0     0     0     1     1
60   1  1  0  1  1  1  0     1     0     1     1     1     0     0     1     1
61   0  0  1  1  1  1  0     0     0     0     0     0     0     0     0     0
62   1  0  1  1  1  1  0     0     1     1     1     1     0     0     0     0
63   0  1  1  1  1  1  0     0     0     0     0     0     0     1     1     1
64   1  1  1  1  1  1  0     1     1     1     1     1     0     1     1     1
65   0  0  0  0  0  0  1     0     0     0     0     0     0     0     0     0
66   1  0  0  0  0  0  1     0     0     0     0     0     1     0     0     0
67   0  1  0  0  0  0  1     0     0     0     0     0     0     0     0     0
68   1  1  0  0  0  0  1     1     0     0     0     0     1     0     0     0
69   0  0  1  0  0  0  1     0     0     0     0     0     0     0     0     0
70   1  0  1  0  0  0  1     0     1     0     0     0     1     0     0     0
71   0  1  1  0  0  0  1     0     0     0     0     0     0     1     0     0
72   1  1  1  0  0  0  1     1     1     0     0     0     1     1     0     0
73   0  0  0  1  0  0  1     0     0     0     0     0     0     0     0     0
74   1  0  0  1  0  0  1     0     0     1     0     0     1     0     0     0
75   0  1  0  1  0  0  1     0     0     0     0     0     0     0     1     0
76   1  1  0  1  0  0  1     1     0     1     0     0     1     0     1     0
77   0  0  1  1  0  0  1     0     0     0     0     0     0     0     0     0
78   1  0  1  1  0  0  1     0     1     1     0     0     1     0     0     0
79   0  1  1  1  0  0  1     0     0     0     0     0     0     1     1     0
80   1  1  1  1  0  0  1     1     1     1     0     0     1     1     1     0
81   0  0  0  0  1  0  1     0     0     0     0     0     0     0     0     0
82   1  0  0  0  1  0  1     0     0     0     1     0     1     0     0     0
83   0  1  0  0  1  0  1     0     0     0     0     0     0     0     0     1
84   1  1  0  0  1  0  1     1     0     0     1     0     1     0     0     1
85   0  0  1  0  1  0  1     0     0     0     0     0     0     0     0     0
86   1  0  1  0  1  0  1     0     1     0     1     0     1     0     0     0
87   0  1  1  0  1  0  1     0     0     0     0     0     0     1     0     1
88   1  1  1  0  1  0  1     1     1     0     1     0     1     1     0     1
89   0  0  0  1  1  0  1     0     0     0     0     0     0     0     0     0
90   1  0  0  1  1  0  1     0     0     1     1     0     1     0     0     0
91   0  1  0  1  1  0  1     0     0     0     0     0     0     0     1     1
92   1  1  0  1  1  0  1     1     0     1     1     0     1     0     1     1
93   0  0  1  1  1  0  1     0     0     0     0     0     0     0     0     0
94   1  0  1  1  1  0  1     0     1     1     1     0     1     0     0     0
95   0  1  1  1  1  0  1     0     0     0     0     0     0     1     1     1
96   1  1  1  1  1  0  1     1     1     1     1     0     1     1     1     1
97   0  0  0  0  0  1  1     0     0     0     0     0     0     0     0     0
98   1  0  0  0  0  1  1     0     0     0     0     1     1     0     0     0
99   0  1  0  0  0  1  1     0     0     0     0     0     0     0     0     0
100  1  1  0  0  0  1  1     1     0     0     0     1     1     0     0     0
101  0  0  1  0  0  1  1     0     0     0     0     0     0     0     0     0
102  1  0  1  0  0  1  1     0     1     0     0     1     1     0     0     0
103  0  1  1  0  0  1  1     0     0     0     0     0     0     1     0     0
104  1  1  1  0  0  1  1     1     1     0     0     1     1     1     0     0
105  0  0  0  1  0  1  1     0     0     0     0     0     0     0     0     0
106  1  0  0  1  0  1  1     0     0     1     0     1     1     0     0     0
107  0  1  0  1  0  1  1     0     0     0     0     0     0     0     1     0
108  1  1  0  1  0  1  1     1     0     1     0     1     1     0     1     0
109  0  0  1  1  0  1  1     0     0     0     0     0     0     0     0     0
110  1  0  1  1  0  1  1     0     1     1     0     1     1     0     0     0
111  0  1  1  1  0  1  1     0     0     0     0     0     0     1     1     0
112  1  1  1  1  0  1  1     1     1     1     0     1     1     1     1     0
113  0  0  0  0  1  1  1     0     0     0     0     0     0     0     0     0
114  1  0  0  0  1  1  1     0     0     0     1     1     1     0     0     0
115  0  1  0  0  1  1  1     0     0     0     0     0     0     0     0     1
116  1  1  0  0  1  1  1     1     0     0     1     1     1     0     0     1
117  0  0  1  0  1  1  1     0     0     0     0     0     0     0     0     0
118  1  0  1  0  1  1  1     0     1     0     1     1     1     0     0     0
119  0  1  1  0  1  1  1     0     0     0     0     0     0     1     0     1
120  1  1  1  0  1  1  1     1     1     0     1     1     1     1     0     1
121  0  0  0  1  1  1  1     0     0     0     0     0     0     0     0     0
122  1  0  0  1  1  1  1     0     0     1     1     1     1     0     0     0
123  0  1  0  1  1  1  1     0     0     0     0     0     0     0     1     1
124  1  1  0  1  1  1  1     1     0     1     1     1     1     0     1     1
125  0  0  1  1  1  1  1     0     0     0     0     0     0     0     0     0
126  1  0  1  1  1  1  1     0     1     1     1     1     1     0     0     0
127  0  1  1  1  1  1  1     0     0     0     0     0     0     1     1     1
128  1  1  1  1  1  1  1     1     1     1     1     1     1     1     1     1
    v2:v6 v2:v7 v3:v4 v3:v5 v3:v6 v3:v7 v4:v5 v4:v6 v4:v7 v5:v6 v5:v7 v6:v7
1       0     0     0     0     0     0     0     0     0     0     0     0
2       0     0     0     0     0     0     0     0     0     0     0     0
3       0     0     0     0     0     0     0     0     0     0     0     0
4       0     0     0     0     0     0     0     0     0     0     0     0
5       0     0     0     0     0     0     0     0     0     0     0     0
6       0     0     0     0     0     0     0     0     0     0     0     0
7       0     0     0     0     0     0     0     0     0     0     0     0
8       0     0     0     0     0     0     0     0     0     0     0     0
9       0     0     0     0     0     0     0     0     0     0     0     0
10      0     0     0     0     0     0     0     0     0     0     0     0
11      0     0     0     0     0     0     0     0     0     0     0     0
12      0     0     0     0     0     0     0     0     0     0     0     0
13      0     0     1     0     0     0     0     0     0     0     0     0
14      0     0     1     0     0     0     0     0     0     0     0     0
15      0     0     1     0     0     0     0     0     0     0     0     0
16      0     0     1     0     0     0     0     0     0     0     0     0
17      0     0     0     0     0     0     0     0     0     0     0     0
18      0     0     0     0     0     0     0     0     0     0     0     0
19      0     0     0     0     0     0     0     0     0     0     0     0
20      0     0     0     0     0     0     0     0     0     0     0     0
21      0     0     0     1     0     0     0     0     0     0     0     0
22      0     0     0     1     0     0     0     0     0     0     0     0
23      0     0     0     1     0     0     0     0     0     0     0     0
24      0     0     0     1     0     0     0     0     0     0     0     0
25      0     0     0     0     0     0     1     0     0     0     0     0
26      0     0     0     0     0     0     1     0     0     0     0     0
27      0     0     0     0     0     0     1     0     0     0     0     0
28      0     0     0     0     0     0     1     0     0     0     0     0
29      0     0     1     1     0     0     1     0     0     0     0     0
30      0     0     1     1     0     0     1     0     0     0     0     0
31      0     0     1     1     0     0     1     0     0     0     0     0
32      0     0     1     1     0     0     1     0     0     0     0     0
33      0     0     0     0     0     0     0     0     0     0     0     0
34      0     0     0     0     0     0     0     0     0     0     0     0
35      1     0     0     0     0     0     0     0     0     0     0     0
36      1     0     0     0     0     0     0     0     0     0     0     0
37      0     0     0     0     1     0     0     0     0     0     0     0
38      0     0     0     0     1     0     0     0     0     0     0     0
39      1     0     0     0     1     0     0     0     0     0     0     0
40      1     0     0     0     1     0     0     0     0     0     0     0
41      0     0     0     0     0     0     0     1     0     0     0     0
42      0     0     0     0     0     0     0     1     0     0     0     0
43      1     0     0     0     0     0     0     1     0     0     0     0
44      1     0     0     0     0     0     0     1     0     0     0     0
45      0     0     1     0     1     0     0     1     0     0     0     0
46      0     0     1     0     1     0     0     1     0     0     0     0
47      1     0     1     0     1     0     0     1     0     0     0     0
48      1     0     1     0     1     0     0     1     0     0     0     0
49      0     0     0     0     0     0     0     0     0     1     0     0
50      0     0     0     0     0     0     0     0     0     1     0     0
51      1     0     0     0     0     0     0     0     0     1     0     0
52      1     0     0     0     0     0     0     0     0     1     0     0
53      0     0     0     1     1     0     0     0     0     1     0     0
54      0     0     0     1     1     0     0     0     0     1     0     0
55      1     0     0     1     1     0     0     0     0     1     0     0
56      1     0     0     1     1     0     0     0     0     1     0     0
57      0     0     0     0     0     0     1     1     0     1     0     0
58      0     0     0     0     0     0     1     1     0     1     0     0
59      1     0     0     0     0     0     1     1     0     1     0     0
60      1     0     0     0     0     0     1     1     0     1     0     0
61      0     0     1     1     1     0     1     1     0     1     0     0
62      0     0     1     1     1     0     1     1     0     1     0     0
63      1     0     1     1     1     0     1     1     0     1     0     0
64      1     0     1     1     1     0     1     1     0     1     0     0
65      0     0     0     0     0     0     0     0     0     0     0     0
66      0     0     0     0     0     0     0     0     0     0     0     0
67      0     1     0     0     0     0     0     0     0     0     0     0
68      0     1     0     0     0     0     0     0     0     0     0     0
69      0     0     0     0     0     1     0     0     0     0     0     0
70      0     0     0     0     0     1     0     0     0     0     0     0
71      0     1     0     0     0     1     0     0     0     0     0     0
72      0     1     0     0     0     1     0     0     0     0     0     0
73      0     0     0     0     0     0     0     0     1     0     0     0
74      0     0     0     0     0     0     0     0     1     0     0     0
75      0     1     0     0     0     0     0     0     1     0     0     0
76      0     1     0     0     0     0     0     0     1     0     0     0
77      0     0     1     0     0     1     0     0     1     0     0     0
78      0     0     1     0     0     1     0     0     1     0     0     0
79      0     1     1     0     0     1     0     0     1     0     0     0
80      0     1     1     0     0     1     0     0     1     0     0     0
81      0     0     0     0     0     0     0     0     0     0     1     0
82      0     0     0     0     0     0     0     0     0     0     1     0
83      0     1     0     0     0     0     0     0     0     0     1     0
84      0     1     0     0     0     0     0     0     0     0     1     0
85      0     0     0     1     0     1     0     0     0     0     1     0
86      0     0     0     1     0     1     0     0     0     0     1     0
87      0     1     0     1     0     1     0     0     0     0     1     0
88      0     1     0     1     0     1     0     0     0     0     1     0
89      0     0     0     0     0     0     1     0     1     0     1     0
90      0     0     0     0     0     0     1     0     1     0     1     0
91      0     1     0     0     0     0     1     0     1     0     1     0
92      0     1     0     0     0     0     1     0     1     0     1     0
93      0     0     1     1     0     1     1     0     1     0     1     0
94      0     0     1     1     0     1     1     0     1     0     1     0
95      0     1     1     1     0     1     1     0     1     0     1     0
96      0     1     1     1     0     1     1     0     1     0     1     0
97      0     0     0     0     0     0     0     0     0     0     0     1
98      0     0     0     0     0     0     0     0     0     0     0     1
99      1     1     0     0     0     0     0     0     0     0     0     1
100     1     1     0     0     0     0     0     0     0     0     0     1
101     0     0     0     0     1     1     0     0     0     0     0     1
102     0     0     0     0     1     1     0     0     0     0     0     1
103     1     1     0     0     1     1     0     0     0     0     0     1
104     1     1     0     0     1     1     0     0     0     0     0     1
105     0     0     0     0     0     0     0     1     1     0     0     1
106     0     0     0     0     0     0     0     1     1     0     0     1
107     1     1     0     0     0     0     0     1     1     0     0     1
108     1     1     0     0     0     0     0     1     1     0     0     1
109     0     0     1     0     1     1     0     1     1     0     0     1
110     0     0     1     0     1     1     0     1     1     0     0     1
111     1     1     1     0     1     1     0     1     1     0     0     1
112     1     1     1     0     1     1     0     1     1     0     0     1
113     0     0     0     0     0     0     0     0     0     1     1     1
114     0     0     0     0     0     0     0     0     0     1     1     1
115     1     1     0     0     0     0     0     0     0     1     1     1
116     1     1     0     0     0     0     0     0     0     1     1     1
117     0     0     0     1     1     1     0     0     0     1     1     1
118     0     0     0     1     1     1     0     0     0     1     1     1
119     1     1     0     1     1     1     0     0     0     1     1     1
120     1     1     0     1     1     1     0     0     0     1     1     1
121     0     0     0     0     0     0     1     1     1     1     1     1
122     0     0     0     0     0     0     1     1     1     1     1     1
123     1     1     0     0     0     0     1     1     1     1     1     1
124     1     1     0     0     0     0     1     1     1     1     1     1
125     0     0     1     1     1     1     1     1     1     1     1     1
126     0     0     1     1     1     1     1     1     1     1     1     1
127     1     1     1     1     1     1     1     1     1     1     1     1
128     1     1     1     1     1     1     1     1     1     1     1     1
    v1:v2:v3 v1:v2:v4 v1:v2:v5 v1:v2:v6 v1:v2:v7 v1:v3:v4 v1:v3:v5 v1:v3:v6
1          0        0        0        0        0        0        0        0
2          0        0        0        0        0        0        0        0
3          0        0        0        0        0        0        0        0
4          0        0        0        0        0        0        0        0
5          0        0        0        0        0        0        0        0
6          0        0        0        0        0        0        0        0
7          0        0        0        0        0        0        0        0
8          1        0        0        0        0        0        0        0
9          0        0        0        0        0        0        0        0
10         0        0        0        0        0        0        0        0
11         0        0        0        0        0        0        0        0
12         0        1        0        0        0        0        0        0
13         0        0        0        0        0        0        0        0
14         0        0        0        0        0        1        0        0
15         0        0        0        0        0        0        0        0
16         1        1        0        0        0        1        0        0
17         0        0        0        0        0        0        0        0
18         0        0        0        0        0        0        0        0
19         0        0        0        0        0        0        0        0
20         0        0        1        0        0        0        0        0
21         0        0        0        0        0        0        0        0
22         0        0        0        0        0        0        1        0
23         0        0        0        0        0        0        0        0
24         1        0        1        0        0        0        1        0
25         0        0        0        0        0        0        0        0
26         0        0        0        0        0        0        0        0
27         0        0        0        0        0        0        0        0
28         0        1        1        0        0        0        0        0
29         0        0        0        0        0        0        0        0
30         0        0        0        0        0        1        1        0
31         0        0        0        0        0        0        0        0
32         1        1        1        0        0        1        1        0
33         0        0        0        0        0        0        0        0
34         0        0        0        0        0        0        0        0
35         0        0        0        0        0        0        0        0
36         0        0        0        1        0        0        0        0
37         0        0        0        0        0        0        0        0
38         0        0        0        0        0        0        0        1
39         0        0        0        0        0        0        0        0
40         1        0        0        1        0        0        0        1
41         0        0        0        0        0        0        0        0
42         0        0        0        0        0        0        0        0
43         0        0        0        0        0        0        0        0
44         0        1        0        1        0        0        0        0
45         0        0        0        0        0        0        0        0
46         0        0        0        0        0        1        0        1
47         0        0        0        0        0        0        0        0
48         1        1        0        1        0        1        0        1
49         0        0        0        0        0        0        0        0
50         0        0        0        0        0        0        0        0
51         0        0        0        0        0        0        0        0
52         0        0        1        1        0        0        0        0
53         0        0        0        0        0        0        0        0
54         0        0        0        0        0        0        1        1
55         0        0        0        0        0        0        0        0
56         1        0        1        1        0        0        1        1
57         0        0        0        0        0        0        0        0
58         0        0        0        0        0        0        0        0
59         0        0        0        0        0        0        0        0
60         0        1        1        1        0        0        0        0
61         0        0        0        0        0        0        0        0
62         0        0        0        0        0        1        1        1
63         0        0        0        0        0        0        0        0
64         1        1        1        1        0        1        1        1
65         0        0        0        0        0        0        0        0
66         0        0        0        0        0        0        0        0
67         0        0        0        0        0        0        0        0
68         0        0        0        0        1        0        0        0
69         0        0        0        0        0        0        0        0
70         0        0        0        0        0        0        0        0
71         0        0        0        0        0        0        0        0
72         1        0        0        0        1        0        0        0
73         0        0        0        0        0        0        0        0
74         0        0        0        0        0        0        0        0
75         0        0        0        0        0        0        0        0
76         0        1        0        0        1        0        0        0
77         0        0        0        0        0        0        0        0
78         0        0        0        0        0        1        0        0
79         0        0        0        0        0        0        0        0
80         1        1        0        0        1        1        0        0
81         0        0        0        0        0        0        0        0
82         0        0        0        0        0        0        0        0
83         0        0        0        0        0        0        0        0
84         0        0        1        0        1        0        0        0
85         0        0        0        0        0        0        0        0
86         0        0        0        0        0        0        1        0
87         0        0        0        0        0        0        0        0
88         1        0        1        0        1        0        1        0
89         0        0        0        0        0        0        0        0
90         0        0        0        0        0        0        0        0
91         0        0        0        0        0        0        0        0
92         0        1        1        0        1        0        0        0
93         0        0        0        0        0        0        0        0
94         0        0        0        0        0        1        1        0
95         0        0        0        0        0        0        0        0
96         1        1        1        0        1        1        1        0
97         0        0        0        0        0        0        0        0
98         0        0        0        0        0        0        0        0
99         0        0        0        0        0        0        0        0
100        0        0        0        1        1        0        0        0
101        0        0        0        0        0        0        0        0
102        0        0        0        0        0        0        0        1
103        0        0        0        0        0        0        0        0
104        1        0        0        1        1        0        0        1
105        0        0        0        0        0        0        0        0
106        0        0        0        0        0        0        0        0
107        0        0        0        0        0        0        0        0
108        0        1        0        1        1        0        0        0
109        0        0        0        0        0        0        0        0
110        0        0        0        0        0        1        0        1
111        0        0        0        0        0        0        0        0
112        1        1        0        1        1        1        0        1
113        0        0        0        0        0        0        0        0
114        0        0        0        0        0        0        0        0
115        0        0        0        0        0        0        0        0
116        0        0        1        1        1        0        0        0
117        0        0        0        0        0        0        0        0
118        0        0        0        0        0        0        1        1
119        0        0        0        0        0        0        0        0
120        1        0        1        1        1        0        1        1
121        0        0        0        0        0        0        0        0
122        0        0        0        0        0        0        0        0
123        0        0        0        0        0        0        0        0
124        0        1        1        1        1        0        0        0
125        0        0        0        0        0        0        0        0
126        0        0        0        0        0        1        1        1
127        0        0        0        0        0        0        0        0
128        1        1        1        1        1        1        1        1
    v1:v3:v7 v1:v4:v5 v1:v4:v6 v1:v4:v7 v1:v5:v6 v1:v5:v7 v1:v6:v7 v2:v3:v4
1          0        0        0        0        0        0        0        0
2          0        0        0        0        0        0        0        0
3          0        0        0        0        0        0        0        0
4          0        0        0        0        0        0        0        0
5          0        0        0        0        0        0        0        0
6          0        0        0        0        0        0        0        0
7          0        0        0        0        0        0        0        0
8          0        0        0        0        0        0        0        0
9          0        0        0        0        0        0        0        0
10         0        0        0        0        0        0        0        0
11         0        0        0        0        0        0        0        0
12         0        0        0        0        0        0        0        0
13         0        0        0        0        0        0        0        0
14         0        0        0        0        0        0        0        0
15         0        0        0        0        0        0        0        1
16         0        0        0        0        0        0        0        1
17         0        0        0        0        0        0        0        0
18         0        0        0        0        0        0        0        0
19         0        0        0        0        0        0        0        0
20         0        0        0        0        0        0        0        0
21         0        0        0        0        0        0        0        0
22         0        0        0        0        0        0        0        0
23         0        0        0        0        0        0        0        0
24         0        0        0        0        0        0        0        0
25         0        0        0        0        0        0        0        0
26         0        1        0        0        0        0        0        0
27         0        0        0        0        0        0        0        0
28         0        1        0        0        0        0        0        0
29         0        0        0        0        0        0        0        0
30         0        1        0        0        0        0        0        0
31         0        0        0        0        0        0        0        1
32         0        1        0        0        0        0        0        1
33         0        0        0        0        0        0        0        0
34         0        0        0        0        0        0        0        0
35         0        0        0        0        0        0        0        0
36         0        0        0        0        0        0        0        0
37         0        0        0        0        0        0        0        0
38         0        0        0        0        0        0        0        0
39         0        0        0        0        0        0        0        0
40         0        0        0        0        0        0        0        0
41         0        0        0        0        0        0        0        0
42         0        0        1        0        0        0        0        0
43         0        0        0        0        0        0        0        0
44         0        0        1        0        0        0        0        0
45         0        0        0        0        0        0        0        0
46         0        0        1        0        0        0        0        0
47         0        0        0        0        0        0        0        1
48         0        0        1        0        0        0        0        1
49         0        0        0        0        0        0        0        0
50         0        0        0        0        1        0        0        0
51         0        0        0        0        0        0        0        0
52         0        0        0        0        1        0        0        0
53         0        0        0        0        0        0        0        0
54         0        0        0        0        1        0        0        0
55         0        0        0        0        0        0        0        0
56         0        0        0        0        1        0        0        0
57         0        0        0        0        0        0        0        0
58         0        1        1        0        1        0        0        0
59         0        0        0        0        0        0        0        0
60         0        1        1        0        1        0        0        0
61         0        0        0        0        0        0        0        0
62         0        1        1        0        1        0        0        0
63         0        0        0        0        0        0        0        1
64         0        1        1        0        1        0        0        1
65         0        0        0        0        0        0        0        0
66         0        0        0        0        0        0        0        0
67         0        0        0        0        0        0        0        0
68         0        0        0        0        0        0        0        0
69         0        0        0        0        0        0        0        0
70         1        0        0        0        0        0        0        0
71         0        0        0        0        0        0        0        0
72         1        0        0        0        0        0        0        0
73         0        0        0        0        0        0        0        0
74         0        0        0        1        0        0        0        0
75         0        0        0        0        0        0        0        0
76         0        0        0        1        0        0        0        0
77         0        0        0        0        0        0        0        0
78         1        0        0        1        0        0        0        0
79         0        0        0        0        0        0        0        1
80         1        0        0        1        0        0        0        1
81         0        0        0        0        0        0        0        0
82         0        0        0        0        0        1        0        0
83         0        0        0        0        0        0        0        0
84         0        0        0        0        0        1        0        0
85         0        0        0        0        0        0        0        0
86         1        0        0        0        0        1        0        0
87         0        0        0        0        0        0        0        0
88         1        0        0        0        0        1        0        0
89         0        0        0        0        0        0        0        0
90         0        1        0        1        0        1        0        0
91         0        0        0        0        0        0        0        0
92         0        1        0        1        0        1        0        0
93         0        0        0        0        0        0        0        0
94         1        1        0        1        0        1        0        0
95         0        0        0        0        0        0        0        1
96         1        1        0        1        0        1        0        1
97         0        0        0        0        0        0        0        0
98         0        0        0        0        0        0        1        0
99         0        0        0        0        0        0        0        0
100        0        0        0        0        0        0        1        0
101        0        0        0        0        0        0        0        0
102        1        0        0        0        0        0        1        0
103        0        0        0        0        0        0        0        0
104        1        0        0        0        0        0        1        0
105        0        0        0        0        0        0        0        0
106        0        0        1        1        0        0        1        0
107        0        0        0        0        0        0        0        0
108        0        0        1        1        0        0        1        0
109        0        0        0        0        0        0        0        0
110        1        0        1        1        0        0        1        0
111        0        0        0        0        0        0        0        1
112        1        0        1        1        0        0        1        1
113        0        0        0        0        0        0        0        0
114        0        0        0        0        1        1        1        0
115        0        0        0        0        0        0        0        0
116        0        0        0        0        1        1        1        0
117        0        0        0        0        0        0        0        0
118        1        0        0        0        1        1        1        0
119        0        0        0        0        0        0        0        0
120        1        0        0        0        1        1        1        0
121        0        0        0        0        0        0        0        0
122        0        1        1        1        1        1        1        0
123        0        0        0        0        0        0        0        0
124        0        1        1        1        1        1        1        0
125        0        0        0        0        0        0        0        0
126        1        1        1        1        1        1        1        0
127        0        0        0        0        0        0        0        1
128        1        1        1        1        1        1        1        1
    v2:v3:v5 v2:v3:v6 v2:v3:v7 v2:v4:v5 v2:v4:v6 v2:v4:v7 v2:v5:v6 v2:v5:v7
1          0        0        0        0        0        0        0        0
2          0        0        0        0        0        0        0        0
3          0        0        0        0        0        0        0        0
4          0        0        0        0        0        0        0        0
5          0        0        0        0        0        0        0        0
6          0        0        0        0        0        0        0        0
7          0        0        0        0        0        0        0        0
8          0        0        0        0        0        0        0        0
9          0        0        0        0        0        0        0        0
10         0        0        0        0        0        0        0        0
11         0        0        0        0        0        0        0        0
12         0        0        0        0        0        0        0        0
13         0        0        0        0        0        0        0        0
14         0        0        0        0        0        0        0        0
15         0        0        0        0        0        0        0        0
16         0        0        0        0        0        0        0        0
17         0        0        0        0        0        0        0        0
18         0        0        0        0        0        0        0        0
19         0        0        0        0        0        0        0        0
20         0        0        0        0        0        0        0        0
21         0        0        0        0        0        0        0        0
22         0        0        0        0        0        0        0        0
23         1        0        0        0        0        0        0        0
24         1        0        0        0        0        0        0        0
25         0        0        0        0        0        0        0        0
26         0        0        0        0        0        0        0        0
27         0        0        0        1        0        0        0        0
28         0        0        0        1        0        0        0        0
29         0        0        0        0        0        0        0        0
30         0        0        0        0        0        0        0        0
31         1        0        0        1        0        0        0        0
32         1        0        0        1        0        0        0        0
33         0        0        0        0        0        0        0        0
34         0        0        0        0        0        0        0        0
35         0        0        0        0        0        0        0        0
36         0        0        0        0        0        0        0        0
37         0        0        0        0        0        0        0        0
38         0        0        0        0        0        0        0        0
39         0        1        0        0        0        0        0        0
40         0        1        0        0        0        0        0        0
41         0        0        0        0        0        0        0        0
42         0        0        0        0        0        0        0        0
43         0        0        0        0        1        0        0        0
44         0        0        0        0        1        0        0        0
45         0        0        0        0        0        0        0        0
46         0        0        0        0        0        0        0        0
47         0        1        0        0        1        0        0        0
48         0        1        0        0        1        0        0        0
49         0        0        0        0        0        0        0        0
50         0        0        0        0        0        0        0        0
51         0        0        0        0        0        0        1        0
52         0        0        0        0        0        0        1        0
53         0        0        0        0        0        0        0        0
54         0        0        0        0        0        0        0        0
55         1        1        0        0        0        0        1        0
56         1        1        0        0        0        0        1        0
57         0        0        0        0        0        0        0        0
58         0        0        0        0        0        0        0        0
59         0        0        0        1        1        0        1        0
60         0        0        0        1        1        0        1        0
61         0        0        0        0        0        0        0        0
62         0        0        0        0        0        0        0        0
63         1        1        0        1        1        0        1        0
64         1        1        0        1        1        0        1        0
65         0        0        0        0        0        0        0        0
66         0        0        0        0        0        0        0        0
67         0        0        0        0        0        0        0        0
68         0        0        0        0        0        0        0        0
69         0        0        0        0        0        0        0        0
70         0        0        0        0        0        0        0        0
71         0        0        1        0        0        0        0        0
72         0        0        1        0        0        0        0        0
73         0        0        0        0        0        0        0        0
74         0        0        0        0        0        0        0        0
75         0        0        0        0        0        1        0        0
76         0        0        0        0        0        1        0        0
77         0        0        0        0        0        0        0        0
78         0        0        0        0        0        0        0        0
79         0        0        1        0        0        1        0        0
80         0        0        1        0        0        1        0        0
81         0        0        0        0        0        0        0        0
82         0        0        0        0        0        0        0        0
83         0        0        0        0        0        0        0        1
84         0        0        0        0        0        0        0        1
85         0        0        0        0        0        0        0        0
86         0        0        0        0        0        0        0        0
87         1        0        1        0        0        0        0        1
88         1        0        1        0        0        0        0        1
89         0        0        0        0        0        0        0        0
90         0        0        0        0        0        0        0        0
91         0        0        0        1        0        1        0        1
92         0        0        0        1        0        1        0        1
93         0        0        0        0        0        0        0        0
94         0        0        0        0        0        0        0        0
95         1        0        1        1        0        1        0        1
96         1        0        1        1        0        1        0        1
97         0        0        0        0        0        0        0        0
98         0        0        0        0        0        0        0        0
99         0        0        0        0        0        0        0        0
100        0        0        0        0        0        0        0        0
101        0        0        0        0        0        0        0        0
102        0        0        0        0        0        0        0        0
103        0        1        1        0        0        0        0        0
104        0        1        1        0        0        0        0        0
105        0        0        0        0        0        0        0        0
106        0        0        0        0        0        0        0        0
107        0        0        0        0        1        1        0        0
108        0        0        0        0        1        1        0        0
109        0        0        0        0        0        0        0        0
110        0        0        0        0        0        0        0        0
111        0        1        1        0        1        1        0        0
112        0        1        1        0        1        1        0        0
113        0        0        0        0        0        0        0        0
114        0        0        0        0        0        0        0        0
115        0        0        0        0        0        0        1        1
116        0        0        0        0        0        0        1        1
117        0        0        0        0        0        0        0        0
118        0        0        0        0        0        0        0        0
119        1        1        1        0        0        0        1        1
120        1        1        1        0        0        0        1        1
121        0        0        0        0        0        0        0        0
122        0        0        0        0        0        0        0        0
123        0        0        0        1        1        1        1        1
124        0        0        0        1        1        1        1        1
125        0        0        0        0        0        0        0        0
126        0        0        0        0        0        0        0        0
127        1        1        1        1        1        1        1        1
128        1        1        1        1        1        1        1        1
    v2:v6:v7 v3:v4:v5 v3:v4:v6 v3:v4:v7 v3:v5:v6 v3:v5:v7 v3:v6:v7 v4:v5:v6
1          0        0        0        0        0        0        0        0
2          0        0        0        0        0        0        0        0
3          0        0        0        0        0        0        0        0
4          0        0        0        0        0        0        0        0
5          0        0        0        0        0        0        0        0
6          0        0        0        0        0        0        0        0
7          0        0        0        0        0        0        0        0
8          0        0        0        0        0        0        0        0
9          0        0        0        0        0        0        0        0
10         0        0        0        0        0        0        0        0
11         0        0        0        0        0        0        0        0
12         0        0        0        0        0        0        0        0
13         0        0        0        0        0        0        0        0
14         0        0        0        0        0        0        0        0
15         0        0        0        0        0        0        0        0
16         0        0        0        0        0        0        0        0
17         0        0        0        0        0        0        0        0
18         0        0        0        0        0        0        0        0
19         0        0        0        0        0        0        0        0
20         0        0        0        0        0        0        0        0
21         0        0        0        0        0        0        0        0
22         0        0        0        0        0        0        0        0
23         0        0        0        0        0        0        0        0
24         0        0        0        0        0        0        0        0
25         0        0        0        0        0        0        0        0
26         0        0        0        0        0        0        0        0
27         0        0        0        0        0        0        0        0
28         0        0        0        0        0        0        0        0
29         0        1        0        0        0        0        0        0
30         0        1        0        0        0        0        0        0
31         0        1        0        0        0        0        0        0
32         0        1        0        0        0        0        0        0
33         0        0        0        0        0        0        0        0
34         0        0        0        0        0        0        0        0
35         0        0        0        0        0        0        0        0
36         0        0        0        0        0        0        0        0
37         0        0        0        0        0        0        0        0
38         0        0        0        0        0        0        0        0
39         0        0        0        0        0        0        0        0
40         0        0        0        0        0        0        0        0
41         0        0        0        0        0        0        0        0
42         0        0        0        0        0        0        0        0
43         0        0        0        0        0        0        0        0
44         0        0        0        0        0        0        0        0
45         0        0        1        0        0        0        0        0
46         0        0        1        0        0        0        0        0
47         0        0        1        0        0        0        0        0
48         0        0        1        0        0        0        0        0
49         0        0        0        0        0        0        0        0
50         0        0        0        0        0        0        0        0
51         0        0        0        0        0        0        0        0
52         0        0        0        0        0        0        0        0
53         0        0        0        0        1        0        0        0
54         0        0        0        0        1        0        0        0
55         0        0        0        0        1        0        0        0
56         0        0        0        0        1        0        0        0
57         0        0        0        0        0        0        0        1
58         0        0        0        0        0        0        0        1
59         0        0        0        0        0        0        0        1
60         0        0        0        0        0        0        0        1
61         0        1        1        0        1        0        0        1
62         0        1        1        0        1        0        0        1
63         0        1        1        0        1        0        0        1
64         0        1        1        0        1        0        0        1
65         0        0        0        0        0        0        0        0
66         0        0        0        0        0        0        0        0
67         0        0        0        0        0        0        0        0
68         0        0        0        0        0        0        0        0
69         0        0        0        0        0        0        0        0
70         0        0        0        0        0        0        0        0
71         0        0        0        0        0        0        0        0
72         0        0        0        0        0        0        0        0
73         0        0        0        0        0        0        0        0
74         0        0        0        0        0        0        0        0
75         0        0        0        0        0        0        0        0
76         0        0        0        0        0        0        0        0
77         0        0        0        1        0        0        0        0
78         0        0        0        1        0        0        0        0
79         0        0        0        1        0        0        0        0
80         0        0        0        1        0        0        0        0
81         0        0        0        0        0        0        0        0
82         0        0        0        0        0        0        0        0
83         0        0        0        0        0        0        0        0
84         0        0        0        0        0        0        0        0
85         0        0        0        0        0        1        0        0
86         0        0        0        0        0        1        0        0
87         0        0        0        0        0        1        0        0
88         0        0        0        0        0        1        0        0
89         0        0        0        0        0        0        0        0
90         0        0        0        0        0        0        0        0
91         0        0        0        0        0        0        0        0
92         0        0        0        0        0        0        0        0
93         0        1        0        1        0        1        0        0
94         0        1        0        1        0        1        0        0
95         0        1        0        1        0        1        0        0
96         0        1        0        1        0        1        0        0
97         0        0        0        0        0        0        0        0
98         0        0        0        0        0        0        0        0
99         1        0        0        0        0        0        0        0
100        1        0        0        0        0        0        0        0
101        0        0        0        0        0        0        1        0
102        0        0        0        0        0        0        1        0
103        1        0        0        0        0        0        1        0
104        1        0        0        0        0        0        1        0
105        0        0        0        0        0        0        0        0
106        0        0        0        0        0        0        0        0
107        1        0        0        0        0        0        0        0
108        1        0        0        0        0        0        0        0
109        0        0        1        1        0        0        1        0
110        0        0        1        1        0        0        1        0
111        1        0        1        1        0        0        1        0
112        1        0        1        1        0        0        1        0
113        0        0        0        0        0        0        0        0
114        0        0        0        0        0        0        0        0
115        1        0        0        0        0        0        0        0
116        1        0        0        0        0        0        0        0
117        0        0        0        0        1        1        1        0
118        0        0        0        0        1        1        1        0
119        1        0        0        0        1        1        1        0
120        1        0        0        0        1        1        1        0
121        0        0        0        0        0        0        0        1
122        0        0        0        0        0        0        0        1
123        1        0        0        0        0        0        0        1
124        1        0        0        0        0        0        0        1
125        0        1        1        1        1        1        1        1
126        0        1        1        1        1        1        1        1
127        1        1        1        1        1        1        1        1
128        1        1        1        1        1        1        1        1
    v4:v5:v7 v4:v6:v7 v5:v6:v7
1          0        0        0
2          0        0        0
3          0        0        0
4          0        0        0
5          0        0        0
6          0        0        0
7          0        0        0
8          0        0        0
9          0        0        0
10         0        0        0
11         0        0        0
12         0        0        0
13         0        0        0
14         0        0        0
15         0        0        0
16         0        0        0
17         0        0        0
18         0        0        0
19         0        0        0
20         0        0        0
21         0        0        0
22         0        0        0
23         0        0        0
24         0        0        0
25         0        0        0
26         0        0        0
27         0        0        0
28         0        0        0
29         0        0        0
30         0        0        0
31         0        0        0
32         0        0        0
33         0        0        0
34         0        0        0
35         0        0        0
36         0        0        0
37         0        0        0
38         0        0        0
39         0        0        0
40         0        0        0
41         0        0        0
42         0        0        0
43         0        0        0
44         0        0        0
45         0        0        0
46         0        0        0
47         0        0        0
48         0        0        0
49         0        0        0
50         0        0        0
51         0        0        0
52         0        0        0
53         0        0        0
54         0        0        0
55         0        0        0
56         0        0        0
57         0        0        0
58         0        0        0
59         0        0        0
60         0        0        0
61         0        0        0
62         0        0        0
63         0        0        0
64         0        0        0
65         0        0        0
66         0        0        0
67         0        0        0
68         0        0        0
69         0        0        0
70         0        0        0
71         0        0        0
72         0        0        0
73         0        0        0
74         0        0        0
75         0        0        0
76         0        0        0
77         0        0        0
78         0        0        0
79         0        0        0
80         0        0        0
81         0        0        0
82         0        0        0
83         0        0        0
84         0        0        0
85         0        0        0
86         0        0        0
87         0        0        0
88         0        0        0
89         1        0        0
90         1        0        0
91         1        0        0
92         1        0        0
93         1        0        0
94         1        0        0
95         1        0        0
96         1        0        0
97         0        0        0
98         0        0        0
99         0        0        0
100        0        0        0
101        0        0        0
102        0        0        0
103        0        0        0
104        0        0        0
105        0        1        0
106        0        1        0
107        0        1        0
108        0        1        0
109        0        1        0
110        0        1        0
111        0        1        0
112        0        1        0
113        0        0        1
114        0        0        1
115        0        0        1
116        0        0        1
117        0        0        1
118        0        0        1
119        0        0        1
120        0        0        1
121        1        1        1
122        1        1        1
123        1        1        1
124        1        1        1
125        1        1        1
126        1        1        1
127        1        1        1
128        1        1        1
attr(,"assign")
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
[51] 51 52 53 54 55 56 57 58 59 60 61 62 63
>  resp
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20 
  0   8   7   8   9   7   9   5   0   4   5  10   4   2   6   7  11   6   4   0 
 21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40 
  6   3   9   5   5   3   5   0   3   3   5   9   0   5   2   4   3   2   3   5 
 41  42  43  44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60 
  0   4   3   6   5   6   6   5  12   7   5   0   7   8   3   4   7   6   5   0 
 61  62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80 
  3   7   3   9   0   3   1   2   5   1   4   3   0   5   5   4   1   2   6   1 
 81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 
  3   2   5   0   4   2   5   6   3   2   4   0   4   5   6  11   0   8   3   5 
101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 
  0   1   3   2   0   2  14  10   2   5   8   4   2   4   2   0   3   4   2   3 
121 122 123 124 125 126 127 128 
  5   7   5   0   3   6   3  10 
>  offs
NULL
> 
>  # have to deal with dropped predictors
>  outies <- is.na(coefficients(gout))
> 
>  mymodmat <- modmat[ , ! outies]
> 
>  mlogl <- glmdr:::make.mlogl(mymodmat, resp, offs, "poisson")
> 
>  beta.test <- coefficients(gout)[! outies]
>  # we don't want to test where the gradient is nearly zero
>  beta.test <- 0.9 * beta.test
> 
>  mout <- mlogl(beta.test)
> 
>  # omit offset here because it is NULL
>  theta.test <- as.vector(mymodmat %*% beta.test)
>  mu.test <- exp(theta.test)
> 
>  myval <- sum(- resp * theta.test + mu.test)
> 
>  all.equal(mout$value, myval)
[1] TRUE
> 
>  mygrad <- grad(function(beta) mlogl(beta)$value, beta.test)
> 
>  all.equal(mout$gradient, mygrad)
[1] TRUE
> 
>  myhess <- jacobian(function(beta) mlogl(beta)$gradient, beta.test)
> 
>  all.equal(mout$hessian, myhess)
[1] TRUE
> 
> 
> proc.time()
   user  system elapsed 
  1.744   0.104   1.842 
